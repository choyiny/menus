<app-covid-modal [menu]="menu"></app-covid-modal>
<div *ngIf="menu">
  <div class="desktop-background">
    <div class="header">
      <div
        [style.background-image]="
          'linear-gradient(to bottom, rgba(255, 255, 255, 0.52), rgba(0, 0, 0, 0.73)), url(' + menu.image + ')'
        "
        class="background-image"
      >
        <button *ngIf="!rearrangeMode && hasPermission" (click)="rearrange()">Rearrange Sections</button>
        <button *ngIf="rearrangeMode && hasPermission" (click)="saveSections()">Save</button>
        <div class="card-overlay">
          <div *ngIf="!editMode" class="overlay-container">
            <h1>{{ menu.name }}</h1>
          </div>
          <div *ngIf="editMode" class="overlay-container">
            <input class="name-input" [style.width.ch]="menu.name.length" type="text" [(ngModel)]="menu.name" />
            <!--            <input type="text" [(ngModel)]="menu.image" />-->
          </div>
        </div>
        <div class="bio">
          <quill-view-html
            *ngIf="!editMode"
            [content]="injectHeaderStyle(menu.description)"
            theme="snow"
          ></quill-view-html>
          <quill-editor *ngIf="editMode" [(ngModel)]="menu.description"></quill-editor>
        </div>
      </div>
    </div>
    <app-scrolling-component
      class="mobile"
      [sections]="menu.sections"
      [miniScroll]="miniScroll"
    ></app-scrolling-component>
    <div
      [ngStyle]="{
        background: 'url(' + menu.image + ')',
        backgroundSize: '100%',
        backgroundRepeat: 'no repeat'
      }"
      class="desktop-image"
    >
      <div class="desktop-background">
        <!--        <div class="desktop-description">-->
        <!--          <button *ngIf="!editMode && hasPermission" (click)="edit()">Edit</button>-->
        <!--          <button *ngIf="editMode" (click)="sendRequest()">Save</button>-->
        <!--          <h1 class="desc">{{ menu.name }}</h1>-->
        <!--          <div class="quill-view">-->
        <!--            <quill-view-html-->
        <!--              *ngIf="!editMode"-->
        <!--              [content]="injectHeaderStyle(menu.description)"-->
        <!--              theme="snow"-->
        <!--            ></quill-view-html>-->
        <!--            <quill-editor *ngIf="editMode" [(ngModel)]="menu.description"></quill-editor>-->
        <!--          </div>-->
        <!--        </div>-->
        <div class="desktop-description desktop">
          <h1 *ngIf="!editMode" class="desc">{{ menu.name }}</h1>
          <input
            *ngIf="editMode"
            class="desc"
            [style.width.ch]="menu.name.length"
            type="text"
            [(ngModel)]="menu.name"
          />
          <button *ngIf="!editMode && hasPermission" (click)="edit()">Edit</button>
          <button *ngIf="editMode" (click)="sendRequest()">Save</button>
        </div>
        <div class="menu-items section-background">
          <div cdkDropList [cdkDropListData]="menu.sections" (cdkDropListDropped)="drop($event)">
            <div
              class="section-box"
              *ngFor="let section of menu.sections; let i = index"
              cdkDrag
              [cdkDragDisabled]="!rearrangeMode"
            >
              <app-section
                [rearrangeMode]="rearrangeMode"
                [hasPermission]="hasPermission"
                [section]="section"
                [slug]="slug"
                id="{{ section._id }}"
              >
              </app-section>
              <button *ngIf="!rearrangeMode && hasPermission" (click)="newSection(i)">Add new Section</button>
            </div>
          </div>
        </div>
      </div>
    </div>
    <app-footer></app-footer>
  </div>
</div>
