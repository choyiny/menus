<app-covid-modal [menu]="menu"></app-covid-modal>
<div *ngIf="menu">
  <div class="desktop-background">
    <div class="mobile header">
      <div
        [style.background-image]="
          'linear-gradient(to bottom, rgba(255, 255, 255, 0.52), rgba(0, 0, 0, 0.73)), url(' + menu.image + ')'
        "
        class="background-image"
      >
        <button *ngIf="!rearrangeMode && hasPermission" (click)="rearrange()">Rearrange Sections</button>
        <button *ngIf="rearrangeMode && hasPermission" (click)="saveSections()">Save</button>
        <div class="card-overlay">
          <div class="overlay-container">
            <h1>{{ menu.name }}</h1>
          </div>
        </div>
        <div class="bio">
          <quill-view-html [content]="injectHeaderStyle(menu.description)" theme="snow"></quill-view-html>
        </div>
      </div>
    </div>
    <app-scrolling-component
      class="mobile"
      [sections]="menu.sections"
      [miniScroll]="miniScroll"
    ></app-scrolling-component>
    <div
      [ngStyle]="{
        background: 'url(' + menu.image + ')',
        backgroundSize: '100%',
        backgroundRepeat: 'no repeat'
      }"
      class="desktop-image"
    >
      <div class="desktop-background">
        <app-menu-name
          class="desktop"
          (menuEmitter)="setValue($event)"
          [hasPermission]="hasPermission"
          [name]="menu.name"
        ></app-menu-name>
        <div class="menu-items section-background">
          <app-menu-details
            class="desktop"
            [description]="menu.description"
            [hasPermission]="hasPermission"
            (menuEmitter)="setValue($event)"
          ></app-menu-details>
          <app-scrolling-component
            class="desktop"
            [sections]="menu.sections"
            [miniScroll]="miniScroll"
          ></app-scrolling-component>
          <div cdkDropList [cdkDropListData]="menu.sections" (cdkDropListDropped)="drop($event)">
            <div
              class="section-box"
              *ngFor="let section of menu.sections; let i = index"
              cdkDrag
              [cdkDragDisabled]="!rearrangeMode"
            >
              <app-section
                [rearrangeMode]="rearrangeMode"
                [hasPermission]="hasPermission"
                [section]="section"
                [slug]="slug"
                id="{{ section._id }}"
              >
              </app-section>
              <button *ngIf="!rearrangeMode && hasPermission" (click)="newSection(i)">Add new Section</button>
            </div>
          </div>
        </div>
      </div>
    </div>
    <app-footer></app-footer>
  </div>
</div>
